同源策略和跨域
1.什么是同源策略
同源策略是浏览器安全的一个策略，具体来讲，当对网页做一定的操作时，比如读取Cookie、LocalStrorage、IndexDB、DOM操作、发起Ajax，那么操作与被操作页面则必须满足下列三个相同 协议、域名、端口相同，被称为同源。可以通过`window.origin`或`location.origin`得到当前源。不同源不能互相访问数据。
2.为什么
没有同源策略很容易被攻击，比如一个页面A，我在页面A里去拿属于不同源的页面B的cookie之类的，对B页面的服务器发起请求等等。

为什么可以跨域使用CSS、JS和图片等？
同源策略限制的是数据访问，我们引用`CSS`、`JS`和图片的时候，其实并不知道其内容，我们只是在引用。
3.请求是成功的吗

4.带来的问题
（1）跨域问题
同源策略在早期是没什么问题，可是随着微服务的发展，问题的比较明显了，因为很多微服务域名是都不同的，而一个前端通常情况下，需要对接N个微服务的。这就是跨域问题。
（2）页面通信问题
有时，我们是希望在多个页面间进行通信，但由于同源策略导致的DOM限制操作，我们是不能直接通过iframe操作其它非同源页面的DOM的
（3）通用存储问题
想建立一个统一的前端数据库，用在多个微服务前端页面共用数据，不好意思，这也不行

5.跨域解决方案
（1）CORS方案（跨域资源共享）
CORS即Cross-origin resource sharing，是一个W3C标准，定义了跨域资源时浏览器与服务器沟通方案。这个方案是由服务器处理的，前端基本不需要处理。对前端开发者来说，非常透明，操作不需要做什么。缺点，就是浏览器需要IE10以上。
`CORS`跨域分为两种请求，一种是**简单请求**，另外一种就是**复杂请求**。
简单请求：

-   请求方式为`HEAD`、`POST` 或者 `GET`
-   http头信息不超出以下字段：`Accept`、`Accept-Language` 、 `Content-Language`、 `Last-Event-ID`、 `Content-Type`(限于三个值：`application/x-www-form-urlencoded`、`multipart/form-data`、`text/plain`)

简单请求的实现具体来说就是在信息头中加入一个`Origin`字段：
  
复杂请求：
使用CORS，你会发现你在发起非简单请求时，浏览器会发起两次请求，其实浏览器在发送真正的请求之前，会先发送一个 Preflight 请求给服务器，这种请求使用 OPTIONS 方法，发送下列头部：

-   Origin：与简单的请求相同。
-   Access-Control-Request-Method: 请求自身使用的方法。
-   Access-Control-Request-Headers: （可选）自定义的头部信息，多个头部以逗号分隔。

发送这个请求后，服务器可以决定是否允许这种类型的请求。服务器通过在响应中发送如下头部与浏览器进行沟通：

-   Access-Control-Allow-Origin：与简单的请求相同。
-   Access-Control-Allow-Methods: 允许的方法，多个方法以逗号分隔。
-   Access-Control-Allow-Headers: 允许的头部，多个方法以逗号分隔。
-   Access-Control-Max-Age: 应该将这个 Preflight 请求缓存多长时间（以秒表示）。

一旦服务器通过 Preflight 请求允许该请求之后，以后每次浏览器正常的 CORS 请求，就都跟简单请求一样了。
（3）JSONP方案
纯前端方案了，他的原理就是利用了浏览器对Script脚本可以加载非同源脚本的功能，用这个功能进行请求处理，当然，这只能进行请求数据，提交数据就无能为力了。我们就请求一个 `JS` 文件，这个 `JS` 文件会执行一个回调，回调里面就有我们需要的数据。
服务端：
如客户想访问 : https://www.runoob.com/try/ajax/jsonp.php?jsoncallback=callback
假设客户期望返回数据：["customername1","customername2"]
真正返回到客户端的数据显示为: callback(["customername1","customername2"])
客户端
```
let script = document.createElement('script');

script.src = 'http://www.wang.cn/login?username=wang&callback=callback';

document.body.appendChild(script);

function callback(res) {
  console.log(res);
}

```
（2）-   WebSocket
会带一个Origin信息，这个信息就是请求者信息，服务端是知道谁请求的，所以说，大家都知根知底，就没必要做些多余的事了。
（3）反向代理服务器
配置代理服务器
代理服务器和前端所处同域，加在前端和真实请求服务器之间。
开启方式：1.Nginx 2.借助VUE-CLI devServer.proxy

（4）-   BFF方案
BFF就是Back-end For Front-end，中文是服务前端的后端，就是用Node.js开发一个服务于前端的后端，这样这个后端就和前端是同源的，而和微服务的请求是由Node.js来发起，因为不是浏览器，所以就没有同源的限制了。

6.页面通信解决方案
-   PostMessage

7.